<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subtitle Generator</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header with Theme Toggle -->
        <header>
            <div class="header-content">
                <h1>Subtitle Generator</h1>
                <p class="subtitle">Batch subtitle generation using Deepgram Nova-3 API</p>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                <svg class="theme-icon theme-icon-dark" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                </svg>
                <svg class="theme-icon theme-icon-light" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" style="display: none;">
                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>
                </svg>
            </button>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Action Bar (Sticky) - Enhanced -->
            <div class="action-bar">
                <div class="cost-summary">
                    <div class="cost-primary" id="costPrimary">0 files selected</div>
                    <div class="cost-secondary" id="costSecondary">Select videos to see estimates</div>
                </div>
                <div class="job-status-compact" id="jobStatusCompact" style="display:none;">
                    <div class="cost-primary" id="jobStatusText">Processing...</div>
                    <div class="cost-secondary" id="jobStatusDetails">0 / 0 completed</div>
                </div>
                <button onclick="submitBatch()" id="submitBtn" class="btn-primary" disabled>Select Files to Continue</button>
            </div>

            <!-- File Selection Section -->
            <section aria-label="File selection">
                <div class="card">
                    <!-- Current Directory Display -->
                    <div class="breadcrumb" id="breadcrumb">
                        <span class="breadcrumb-item current">media</span>
                    </div>

                    <!-- Directory Browser -->
                    <div id="directoryBrowser">
                        <div id="directoryList" class="files-list">
                            <div id="skeleton" class="skeleton-loader hidden">
                                <div class="skeleton-item"></div>
                                <div class="skeleton-item"></div>
                                <div class="skeleton-item"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Selection Actions with Overwrite Option -->
                    <div class="browser-toolbar" style="border-bottom: none; padding-top: var(--space-m);">
                        <div class="toolbar-left">
                            <label class="checkbox-label" style="margin: 0;">
                                <input type="checkbox" id="forceRegenerate">
                                <span>Overwrite Existing Subtitles</span>
                            </label>
                        </div>
                        <div class="toolbar-right">
                            <button class="btn-link" onclick="selectAll()">Select All</button>
                            <span class="separator">•</span>
                            <button class="btn-link" onclick="selectNone()">Clear</button>
                        </div>
                    </div>

                    <!-- Configuration Options -->
                    <div class="config-section" style="margin-top: var(--space-l);">
                        <div class="form-group">
                            <label for="language">Audio Language</label>
                            <select id="language">
                                <option value="en">English</option>
                                <option value="en-US">English (US)</option>
                                <option value="en-AU">English (Australia)</option>
                                <option value="en-GB">English (UK)</option>
                                <option value="en-IN">English (India)</option>
                                <option value="en-NZ">English (New Zealand)</option>
                                <option value="en-CA">English (Canada)</option>
                                <option value="en-IE">English (Ireland)</option>
                                <option value="es">Spanish</option>
                                <option value="es-419">Spanish (Latin America)</option>
                                <option value="fr">French</option>
                                <option value="fr-CA">French (Canada)</option>
                                <option value="de">German</option>
                                <option value="hi">Hindi</option>
                                <option value="ru">Russian</option>
                                <option value="pt">Portuguese</option>
                                <option value="pt-BR">Portuguese (Brazil)</option>
                                <option value="pt-PT">Portuguese (Portugal)</option>
                                <option value="ja">Japanese</option>
                                <option value="it">Italian</option>
                                <option value="nl">Dutch</option>
                                <option value="sv">Swedish</option>
                                <option value="sv-SE">Swedish (Sweden)</option>
                                <option value="da">Danish</option>
                                <option value="da-DK">Danish (Denmark)</option>
                                <option value="tr">Turkish</option>
                                <option value="no">Norwegian</option>
                                <option value="id">Indonesian</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="keyTerms">Keyterm Prompting (optional)</label>
                            <textarea id="keyTerms" rows="7" placeholder="e.g., Deepgram, iPhone, customer service" aria-label="Keyterm prompting (optional)"></textarea>
                            <small style="color: var(--text-tertiary); display: block; margin-top: var(--space-xs);">
                                Keyterms are auto-loaded and auto-saved from CSV if available. Use AI generation in Advanced Options below.
                            </small>
                        </div>

                        <!-- Advanced Options Toggle -->
                        <div style="margin-top: var(--space-m); text-align: center;">
                            <button class="btn-link" onclick="toggleAdvancedOptions()" id="advancedToggle" style="font-size: var(--font-caption); color: var(--text-tertiary);">
                                Show Advanced Options ▼
                            </button>
                        </div>
                    </div>

                    <!-- Advanced Options (Collapsible) -->
                    <div id="advancedOptions" class="config-section hidden" style="padding-top: var(--space-l);">
                        <div class="form-group">
                            <label for="profanityFilter">Profanity Filter</label>
                            <select id="profanityFilter">
                                <option value="off">Off</option>
                                <option value="tag">Tag</option>
                                <option value="remove">Remove</option>
                            </select>
                        </div>
                        
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enableTranscript" onchange="toggleTranscriptOptions()">
                                <span>Generate Transcript</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="saveRawJson">
                                <span>Save Raw JSON</span>
                            </label>
                        </div>
                        
                        <div id="transcriptOptions" style="display: none; margin-top: var(--space-m);">
                            <div class="status info">
                                <span style="color: var(--color-blue); font-size: var(--font-caption);">
                                    ℹ️ Speaker maps auto-detected from Transcripts/Speakermap/speakers.csv
                                </span>
                            </div>
                        </div>
                        
                        <!-- LLM Keyterm Generation -->
                        <div class="llm-settings" style="margin-top: var(--space-l);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-m);">
                                <h4 style="margin: 0;">AI Keyterm Generation</h4>
                                <span id="keytermCostEstimate" style="color: var(--text-tertiary); font-size: var(--font-small);"></span>
                            </div>
                            
                            <div class="form-group">
                                <label for="llmProvider">
                                    LLM Provider
                                    <span id="apiKeyStatus" class="api-key-status" title="API key status"></span>
                                </label>
                                <select id="llmProvider">
                                    <option value="anthropic">Anthropic (Claude)</option>
                                    <option value="openai">OpenAI (GPT)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="llmModel">Model</label>
                                <select id="llmModel">
                                    <option value="claude-sonnet-4-5">Claude Sonnet 4.5 (Best Quality)</option>
                                    <option value="claude-haiku-4-5">Claude Haiku 4.5 (Faster, Cheaper)</option>
                                </select>
                            </div>
                            
                            <label class="checkbox-label">
                                <input type="checkbox" id="preserveExisting">
                                <span>Merge with existing keyterms (instead of replacing)</span>
                            </label>
                            
                            <button id="generateKeytermsBtn" class="btn-secondary" style="width: 100%; margin-top: var(--space-m);" title="Generate keyterms using AI">
                                <span class="icon">🤖</span> Generate Keyterms with AI
                            </button>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer style="text-align: center; color: var(--text-tertiary); font-size: var(--font-small); margin-top: var(--space-xl);">
            <p>Keyboard shortcuts: <kbd>Ctrl/⌘+A</kbd> Select All • <kbd>Esc</kbd> Clear • <kbd>Enter</kbd> Transcribe • <kbd>Ctrl/⌘+T</kbd> Theme</p>
        </footer>
    </div>

    <!-- Screen Reader Announcer -->
    <div aria-live="polite" aria-atomic="true" class="sr-only" id="status-announcer"></div>

    <script src="/static/app.js"></script>
</body>
</html>